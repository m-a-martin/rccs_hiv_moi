%TEMPLATE_COMMENTS
\nonstopmode
\documentclass[10pt,letterpaper]{article}
\usepackage[top=1in,left=1in,right=1in,bottom=1in]{geometry}

% long tables
\usepackage{longtable}

% amsmath and amssymb packages, useful for mathematical formulas and symbols
\usepackage{amsmath,amssymb, mathtools}
\newcommand{\one}[1]{\mathop{{}\mathbf{1}}\nolimits_{#1}}

% textcomp package and marvosym package for additional characters
\usepackage{textcomp,marvosym}

% array package and thick rules for tables
\usepackage{array}

% create "+" rule type for thick vertical lines
\newcolumntype{+}{!{\vrule width 2pt}}

% create \thickcline for thick horizontal lines of variable length
\newlength\savedwidth
\newcommand\thickcline[1]{%
  \noalign{\global\savedwidth\arrayrulewidth\global\arrayrulewidth 2pt}%
  \cline{#1}%
  \noalign{\vskip\arrayrulewidth}%
  \noalign{\global\arrayrulewidth\savedwidth}%
}

% \thickhline command for thick horizontal lines that span the table
\newcommand\thickhline{\noalign{\global\savedwidth\arrayrulewidth\global\arrayrulewidth 2pt}%
\hline
\noalign{\global\arrayrulewidth\savedwidth}}



\usepackage{datatool}
\DTLsetseparator{,}% Set the separator between the columns.
% todo add statistics file directly into this document
\DTLloaddbtex{\mydata}{../../output/statistics.dbtex}
\newcommand{\var}[1]{\DTLfetch{\mydata}{labels}{#1}{vals}}


\begin{document}
\begin{table}[!ht]
%TBL_ADJUST_WIDTH_START
\centering
\begin{tabular}[t]{|l|c|c|c|}
\hline
&\multicolumn{3}{c|}{Participants} \\
& & \multicolumn{2}{c|}{Living w/ HIV (\%)}\\
& All & $n$ (\%) & \% of All \\ \thickhline

Overall & \var{n_participants} & \var{n_hiv_participants} & \var{n_hiv_participant_visits} \\ \hline
Survey Round & & &  \\ \hline
\hspace{3mm}\var{round_14_median_year} & \var{n_participant_round_14} (\var{p_participant_round_14}\%) & 
  \var{n_hiv_participant_round_14} (\var{p_hiv_participant_round_14}\%) & \var{p_sample_hiv_participant_round_14} \\ \hline
\hspace{3mm}\var{round_15_median_year} & \var{n_participant_round_15} (\var{p_participant_round_15}\%) & 
  \var{n_hiv_participant_round_15} (\var{p_hiv_participant_round_15}\%)  & \var{p_sample_hiv_participant_round_15} \\ \hline
\hspace{3mm}\var{round_16_median_year} & \var{n_participant_round_16} (\var{p_participant_round_16}\%) & 
  \var{n_hiv_participant_round_16} (\var{p_hiv_participant_round_16}\%)  & \var{p_sample_hiv_participant_round_16} \\ \hline
\hspace{3mm}\var{round_17_median_year} & \var{n_participant_round_17} (\var{p_participant_round_17}\%) & 
  \var{n_hiv_participant_round_17} (\var{p_hiv_participant_round_17}\%)  & \var{p_sample_hiv_participant_round_17} \\ \hline
\hspace{3mm}\var{round_18_median_year} & \var{n_participant_round_18} (\var{p_participant_round_18}\%) & 
  \var{n_hiv_participant_round_18} (\var{p_hiv_participant_round_18}\%)  & \var{p_sample_hiv_participant_round_18} \\ \hline
\hspace{3mm}\var{round_19_median_year} & \var{n_participant_round_19} (\var{p_participant_round_19}\%) & 
  \var{n_hiv_participant_round_19} (\var{p_hiv_participant_round_19}\%)  & \var{p_sample_hiv_participant_round_19} \\ \hline

Sex & & &  \\ \hline
\hspace{3mm}Female & \var{n_participant_sex_F} (\var{p_participant_sex_F}\%) & 
  \var{n_hiv_participant_sex_F} (\var{p_hiv_participant_sex_F}\%)  & \var{p_sample_hiv_participant_sex_F} \\ \hline
\hspace{3mm}Male & \var{n_participant_sex_M} (\var{p_participant_sex_M}\%) & 
  \var{n_hiv_participant_sex_M} (\var{p_hiv_participant_sex_M}\%)  & \var{p_sample_hiv_participant_sex_M} \\ \hline

Commiunity type & & & \\ \hline
\hspace{3mm}Inland & \var{n_participant_comm_type_inland} (\var{p_participant_comm_type_inland}\%) &
  \var{n_hiv_participant_comm_type_inland} (\var{p_hiv_participant_comm_type_inland}\%)  & \var{p_sample_hiv_participant_comm_type_inland} \\ \hline
\hspace{3mm}Fishing & \var{n_participant_comm_type_fishing} (\var{p_participant_comm_type_fishing}\%) &
  \var{n_hiv_participant_comm_type_fishing} (\var{p_hiv_participant_comm_type_fishing}\%) & \var{p_sample_hiv_participant_comm_type_fishing}  \\ \hline

Age & & & \\ \hline
\hspace{3mm}(14, 24] & \var{n_participant_age_cat_coarse_(14,24]} (\var{p_participant_age_cat_coarse_(14,24]}\%) &
  \var{n_hiv_participant_age_cat_coarse_(14,24]} (\var{p_hiv_participant_age_cat_coarse_(14,24]}\%) & \var{p_sample_hiv_participant_age_cat_coarse_(14,24]} \\ \hline
\hspace{3mm}(24, 34] & \var{n_participant_age_cat_coarse_(14,24]} (\var{p_participant_age_cat_coarse_(24,34]}\%) &
  \var{n_hiv_participant_age_cat_coarse_(24,34]} (\var{p_hiv_participant_age_cat_coarse_(24,34]}\%) &  \var{p_sample_hiv_participant_age_cat_coarse_(24,34]}\\ \hline
\hspace{3mm}(34, 49] & \var{n_participant_age_cat_coarse_(34,49]} (\var{p_participant_age_cat_coarse_(34,49]}\%) &
  \var{n_hiv_participant_age_cat_coarse_(34,49]} (\var{p_hiv_participant_age_cat_coarse_(34,49]}\%) &  \var{p_sample_hiv_participant_age_cat_coarse_(34,49]}\\ \hline
\end{tabular}
\end{table}
\end{document}